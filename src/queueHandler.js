"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const AWS = require("aws-sdk");
const SNS_TOPIC_ARN = process.env.SNS_TOPIC_ARN || "";
const SNS_ROLE_ARN = process.env.SNS_ROLE_ARN || "";
const SQS_URL = process.env.SQS_URL || "";
exports.handler = async (event = {}) => {
    console.log("QUEUE HANDLER");
    console.log(SNS_TOPIC_ARN);
    console.log(SNS_ROLE_ARN);
    console.log(SQS_URL);
    console.log(JSON.stringify(event, null, 4));
    const sqs = new AWS.SQS({ endpoint: SQS_URL, region: "us-west-2" });
    const params = {
        QueueUrl: SQS_URL,
        AttributeNames: ["All"],
        MaxNumberOfMessages: 1,
        MessageAttributeNames: ["All"],
        VisibilityTimeout: 20
        // WaitTimeSeconds: 10
    };
    console.log(params);
    // RECEIVE MESSAGES FROM QUEUE
    await new Promise(resolve => {
        sqs.receiveMessage(params, (err, result) => {
            console.log("RECEIVED MESSAGES");
            console.log("YEAHHH");
            console.log(JSON.stringify(result, null, 4));
            console.log(err);
            resolve(result.Messages);
        });
    });
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicXVldWVIYW5kbGVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsicXVldWVIYW5kbGVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsK0JBQStCO0FBQy9CLE1BQU0sYUFBYSxHQUFHLE9BQU8sQ0FBQyxHQUFHLENBQUMsYUFBYSxJQUFJLEVBQUUsQ0FBQztBQUN0RCxNQUFNLFlBQVksR0FBRyxPQUFPLENBQUMsR0FBRyxDQUFDLFlBQVksSUFBSSxFQUFFLENBQUM7QUFDcEQsTUFBTSxPQUFPLEdBQUcsT0FBTyxDQUFDLEdBQUcsQ0FBQyxPQUFPLElBQUksRUFBRSxDQUFDO0FBRTdCLFFBQUEsT0FBTyxHQUFHLEtBQUssRUFBRSxRQUFhLEVBQUUsRUFBZ0IsRUFBRTtJQUM3RCxPQUFPLENBQUMsR0FBRyxDQUFDLGVBQWUsQ0FBQyxDQUFDO0lBQzdCLE9BQU8sQ0FBQyxHQUFHLENBQUMsYUFBYSxDQUFDLENBQUM7SUFDM0IsT0FBTyxDQUFDLEdBQUcsQ0FBQyxZQUFZLENBQUMsQ0FBQztJQUMxQixPQUFPLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQ3JCLE9BQU8sQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxLQUFLLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFFNUMsTUFBTSxHQUFHLEdBQUcsSUFBSSxHQUFHLENBQUMsR0FBRyxDQUFDLEVBQUUsUUFBUSxFQUFFLE9BQU8sRUFBRSxNQUFNLEVBQUUsV0FBVyxFQUFFLENBQUMsQ0FBQztJQUVwRSxNQUFNLE1BQU0sR0FBa0M7UUFDNUMsUUFBUSxFQUFFLE9BQU87UUFDakIsY0FBYyxFQUFFLENBQUMsS0FBSyxDQUFDO1FBQ3ZCLG1CQUFtQixFQUFFLENBQUM7UUFDdEIscUJBQXFCLEVBQUUsQ0FBQyxLQUFLLENBQUM7UUFDOUIsaUJBQWlCLEVBQUUsRUFBRTtRQUNyQixzQkFBc0I7S0FDdkIsQ0FBQztJQUVGLE9BQU8sQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLENBQUM7SUFFcEIsOEJBQThCO0lBQzlCLE1BQU0sSUFBSSxPQUFPLENBQUMsT0FBTyxDQUFDLEVBQUU7UUFDMUIsR0FBRyxDQUFDLGNBQWMsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxHQUFRLEVBQUUsTUFBVyxFQUFFLEVBQUU7WUFDbkQsT0FBTyxDQUFDLEdBQUcsQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDO1lBQ2pDLE9BQU8sQ0FBQyxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUM7WUFDdEIsT0FBTyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLE1BQU0sRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUM3QyxPQUFPLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBQ2pCLE9BQU8sQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDM0IsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIEFXUyBmcm9tIFwiYXdzLXNka1wiO1xuY29uc3QgU05TX1RPUElDX0FSTiA9IHByb2Nlc3MuZW52LlNOU19UT1BJQ19BUk4gfHwgXCJcIjtcbmNvbnN0IFNOU19ST0xFX0FSTiA9IHByb2Nlc3MuZW52LlNOU19ST0xFX0FSTiB8fCBcIlwiO1xuY29uc3QgU1FTX1VSTCA9IHByb2Nlc3MuZW52LlNRU19VUkwgfHwgXCJcIjtcblxuZXhwb3J0IGNvbnN0IGhhbmRsZXIgPSBhc3luYyAoZXZlbnQ6IGFueSA9IHt9KTogUHJvbWlzZTxhbnk+ID0+IHtcbiAgY29uc29sZS5sb2coXCJRVUVVRSBIQU5ETEVSXCIpO1xuICBjb25zb2xlLmxvZyhTTlNfVE9QSUNfQVJOKTtcbiAgY29uc29sZS5sb2coU05TX1JPTEVfQVJOKTtcbiAgY29uc29sZS5sb2coU1FTX1VSTCk7XG4gIGNvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KGV2ZW50LCBudWxsLCA0KSk7XG5cbiAgY29uc3Qgc3FzID0gbmV3IEFXUy5TUVMoeyBlbmRwb2ludDogU1FTX1VSTCwgcmVnaW9uOiBcInVzLXdlc3QtMlwiIH0pO1xuXG4gIGNvbnN0IHBhcmFtczogQVdTLlNRUy5SZWNlaXZlTWVzc2FnZVJlcXVlc3QgPSB7XG4gICAgUXVldWVVcmw6IFNRU19VUkwsXG4gICAgQXR0cmlidXRlTmFtZXM6IFtcIkFsbFwiXSxcbiAgICBNYXhOdW1iZXJPZk1lc3NhZ2VzOiAxLFxuICAgIE1lc3NhZ2VBdHRyaWJ1dGVOYW1lczogW1wiQWxsXCJdLFxuICAgIFZpc2liaWxpdHlUaW1lb3V0OiAyMFxuICAgIC8vIFdhaXRUaW1lU2Vjb25kczogMTBcbiAgfTtcblxuICBjb25zb2xlLmxvZyhwYXJhbXMpO1xuXG4gIC8vIFJFQ0VJVkUgTUVTU0FHRVMgRlJPTSBRVUVVRVxuICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcbiAgICBzcXMucmVjZWl2ZU1lc3NhZ2UocGFyYW1zLCAoZXJyOiBhbnksIHJlc3VsdDogYW55KSA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhcIlJFQ0VJVkVEIE1FU1NBR0VTXCIpO1xuICAgICAgY29uc29sZS5sb2coXCJZRUFISEhcIik7XG4gICAgICBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeShyZXN1bHQsIG51bGwsIDQpKTtcbiAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICByZXNvbHZlKHJlc3VsdC5NZXNzYWdlcyk7XG4gICAgfSk7XG4gIH0pO1xufTtcbiJdfQ==