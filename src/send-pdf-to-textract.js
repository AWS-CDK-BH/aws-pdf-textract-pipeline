"use strict";
// "Records": [
//   {
//     "eventVersion": "2.1",
//     "eventSource": "aws:s3",
//     "awsRegion": "us-west-2",
//     "eventTime": "2020-02-22T22:12:23.990Z",
//     "eventName": "ObjectCreated:Put",
//     "userIdentity": {
//       "principalId": "AWS:AROA4HCFNYRIOZF4TPIG7:LambdaCronExample-fileDownloaderLambdaFunction1D9C-1XPL2Z2WKQXZE"
//     },
//     "requestParameters": {
//       "sourceIPAddress": "52.27.200.91"
//     },
//     "responseElements": {
//       "x-amz-request-id": "8086B5C82D6D010A",
//       "x-amz-id-2": "+bofWAYX2/WJO3i3QWiaU0TgKvfln86JUlW9lG87Pi1z37UH9yxoURHPSWQ8AiMlcgZ4kpploH5yqTjOgukucvDKLLB4nLDD"
//     },
//     "s3": {
//       "s3SchemaVersion": "1.0",
//       "configurationId": "OGY4OTUzOWUtMjQwNC00NmQwLWI1MjEtMzU4ODg1MzI2MjQ4",
//       "bucket": {
//         "name": "lambdacronexample-cogccpdfdownloadsbucket93b40e01-b4wr4268102r",
//         "ownerIdentity": {
//           "principalId": "A3IRW0AE284GDD"
//         },
//         "arn": "arn:aws:s3:::lambdacronexample-cogccpdfdownloadsbucket93b40e01-b4wr4268102r"
//       },
//       "object": {
//         "key": "5055298.pdf",
//         "size": 27,
//         "eTag": "f9c28374e5680f08ac81ac2b3b69b598",
//         "sequencer": "005E51A7489537E7B4"
//       }
//     }
//   }
// ]
Object.defineProperty(exports, "__esModule", { value: true });
// // // //
const AWS = require("aws-sdk");
const db = new AWS.DynamoDB.DocumentClient();
// const textract = new AWS.Textract();
const TABLE_NAME = process.env.TABLE_NAME || "";
const PRIMARY_KEY = process.env.PRIMARY_KEY || "";
const S3_BUCKET_NAME = process.env.S3_BUCKET_NAME || "";
const SNS_TOPIC_ARN = process.env.SNS_TOPIC_ARN || "";
const SNS_ROLE_ARN = process.env.SNS_ROLE_ARN || "";
exports.handler = async (event = {}) => {
    console.log("SEND FILE TO TEXTRACT");
    console.log(SNS_TOPIC_ARN);
    console.log(SNS_ROLE_ARN);
    console.log(JSON.stringify(event, null, 4));
    // Pulls filename from event
    const filename = event["Records"][0]["s3"]["object"]["key"];
    // Short-circuit if filename isn't defined
    if (!filename) {
        console.log("ERROR - filename");
    }
    console.log("filename: " + filename);
    // Defines params for Textract API call
    const textractParams = {
        Document: {
            S3Object: {
                Bucket: S3_BUCKET_NAME,
                Name: filename
                // Version: "STRING_VALUE"
            }
        },
        FeatureTypes: ["TABLES", "FORMS"]
    };
    // Debug AWS Textract params
    console.log("textractParams");
    console.log(JSON.stringify(textractParams, null, 4));
    // // // //
    // // // //
    // Add job to queue
    // // // //
    // // // //
    // Detect the document's text with Textract
    // await new Promise(resolve => {
    //   textract.analyzeDocument(textractParams, async (err: any, data: any) => {
    //     console.log("DONE ANALYZING DOCUMENT");
    //     console.log(err);
    //     console.log(data);
    //     if (err) {
    //       console.log(err, err.stack);
    //       return;
    //     }
    //     // Debug Textract response
    //     console.log("Textract Response");
    //     console.log(JSON.stringify(data, null, 4));
    //     // Defines the item we're inserting into the database
    //     const item: any = {
    //       [PRIMARY_KEY]: filename.replace(".pdf", ""),
    //       // primary_contact_name: "John Doe"
    //       data: {
    //         ...data
    //       }
    //     };
    //     // Defines the params for db.put
    //     const dynamoParams = {
    //       TableName: TABLE_NAME,
    //       Item: item
    //     };
    //     // Inserts the record into the DynamoDB table
    //     await db.put(dynamoParams).promise();
    //     return resolve();
    //   });
    // });
    // return;
    // // // //
    // // // //
    // // // //
    // // // //
    // Defines the item we're inserting into the database
    const item = {
        [PRIMARY_KEY]: Math.random().toString(),
        primary_contact_name: "John Doe"
    };
    // Defines the params for db.put
    const dynamoParams = {
        TableName: TABLE_NAME,
        Item: item
    };
    // Inserts the record into the DynamoDB table
    return db.put(dynamoParams).promise();
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2VuZC1wZGYtdG8tdGV4dHJhY3QuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJzZW5kLXBkZi10by10ZXh0cmFjdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsZUFBZTtBQUNmLE1BQU07QUFDTiw2QkFBNkI7QUFDN0IsK0JBQStCO0FBQy9CLGdDQUFnQztBQUNoQywrQ0FBK0M7QUFDL0Msd0NBQXdDO0FBQ3hDLHdCQUF3QjtBQUN4QixvSEFBb0g7QUFDcEgsU0FBUztBQUNULDZCQUE2QjtBQUM3QiwwQ0FBMEM7QUFDMUMsU0FBUztBQUNULDRCQUE0QjtBQUM1QixnREFBZ0Q7QUFDaEQseUhBQXlIO0FBQ3pILFNBQVM7QUFDVCxjQUFjO0FBQ2Qsa0NBQWtDO0FBQ2xDLCtFQUErRTtBQUMvRSxvQkFBb0I7QUFDcEIsb0ZBQW9GO0FBQ3BGLDZCQUE2QjtBQUM3Qiw0Q0FBNEM7QUFDNUMsYUFBYTtBQUNiLCtGQUErRjtBQUMvRixXQUFXO0FBQ1gsb0JBQW9CO0FBQ3BCLGdDQUFnQztBQUNoQyxzQkFBc0I7QUFDdEIsc0RBQXNEO0FBQ3RELDRDQUE0QztBQUM1QyxVQUFVO0FBQ1YsUUFBUTtBQUNSLE1BQU07QUFDTixJQUFJOztBQUVKLFdBQVc7QUFFWCwrQkFBK0I7QUFDL0IsTUFBTSxFQUFFLEdBQUcsSUFBSSxHQUFHLENBQUMsUUFBUSxDQUFDLGNBQWMsRUFBRSxDQUFDO0FBQzdDLHVDQUF1QztBQUN2QyxNQUFNLFVBQVUsR0FBRyxPQUFPLENBQUMsR0FBRyxDQUFDLFVBQVUsSUFBSSxFQUFFLENBQUM7QUFDaEQsTUFBTSxXQUFXLEdBQUcsT0FBTyxDQUFDLEdBQUcsQ0FBQyxXQUFXLElBQUksRUFBRSxDQUFDO0FBQ2xELE1BQU0sY0FBYyxHQUFHLE9BQU8sQ0FBQyxHQUFHLENBQUMsY0FBYyxJQUFJLEVBQUUsQ0FBQztBQUN4RCxNQUFNLGFBQWEsR0FBRyxPQUFPLENBQUMsR0FBRyxDQUFDLGFBQWEsSUFBSSxFQUFFLENBQUM7QUFDdEQsTUFBTSxZQUFZLEdBQUcsT0FBTyxDQUFDLEdBQUcsQ0FBQyxZQUFZLElBQUksRUFBRSxDQUFDO0FBRXZDLFFBQUEsT0FBTyxHQUFHLEtBQUssRUFBRSxRQUFhLEVBQUUsRUFBZ0IsRUFBRTtJQUM3RCxPQUFPLENBQUMsR0FBRyxDQUFDLHVCQUF1QixDQUFDLENBQUM7SUFDckMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxhQUFhLENBQUMsQ0FBQztJQUMzQixPQUFPLENBQUMsR0FBRyxDQUFDLFlBQVksQ0FBQyxDQUFDO0lBRTFCLE9BQU8sQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxLQUFLLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFFNUMsNEJBQTRCO0lBQzVCLE1BQU0sUUFBUSxHQUFHLEtBQUssQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUU1RCwwQ0FBMEM7SUFDMUMsSUFBSSxDQUFDLFFBQVEsRUFBRTtRQUNiLE9BQU8sQ0FBQyxHQUFHLENBQUMsa0JBQWtCLENBQUMsQ0FBQztLQUNqQztJQUVELE9BQU8sQ0FBQyxHQUFHLENBQUMsWUFBWSxHQUFHLFFBQVEsQ0FBQyxDQUFDO0lBRXJDLHVDQUF1QztJQUN2QyxNQUFNLGNBQWMsR0FBd0M7UUFDMUQsUUFBUSxFQUFFO1lBQ1IsUUFBUSxFQUFFO2dCQUNSLE1BQU0sRUFBRSxjQUFjO2dCQUN0QixJQUFJLEVBQUUsUUFBUTtnQkFDZCwwQkFBMEI7YUFDM0I7U0FDRjtRQUNELFlBQVksRUFBRSxDQUFDLFFBQVEsRUFBRSxPQUFPLENBQUM7S0FDbEMsQ0FBQztJQUVGLDRCQUE0QjtJQUM1QixPQUFPLENBQUMsR0FBRyxDQUFDLGdCQUFnQixDQUFDLENBQUM7SUFDOUIsT0FBTyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLGNBQWMsRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUVyRCxXQUFXO0lBQ1gsV0FBVztJQUVYLG1CQUFtQjtJQUVuQixXQUFXO0lBQ1gsV0FBVztJQUVYLDJDQUEyQztJQUMzQyxpQ0FBaUM7SUFDakMsOEVBQThFO0lBQzlFLDhDQUE4QztJQUM5Qyx3QkFBd0I7SUFDeEIseUJBQXlCO0lBRXpCLGlCQUFpQjtJQUNqQixxQ0FBcUM7SUFDckMsZ0JBQWdCO0lBQ2hCLFFBQVE7SUFFUixpQ0FBaUM7SUFDakMsd0NBQXdDO0lBQ3hDLGtEQUFrRDtJQUVsRCw0REFBNEQ7SUFDNUQsMEJBQTBCO0lBQzFCLHFEQUFxRDtJQUNyRCw0Q0FBNEM7SUFDNUMsZ0JBQWdCO0lBQ2hCLGtCQUFrQjtJQUNsQixVQUFVO0lBQ1YsU0FBUztJQUVULHVDQUF1QztJQUN2Qyw2QkFBNkI7SUFDN0IsK0JBQStCO0lBQy9CLG1CQUFtQjtJQUNuQixTQUFTO0lBRVQsb0RBQW9EO0lBQ3BELDRDQUE0QztJQUM1Qyx3QkFBd0I7SUFDeEIsUUFBUTtJQUNSLE1BQU07SUFFTixVQUFVO0lBRVYsV0FBVztJQUNYLFdBQVc7SUFDWCxXQUFXO0lBQ1gsV0FBVztJQUVYLHFEQUFxRDtJQUNyRCxNQUFNLElBQUksR0FBUTtRQUNoQixDQUFDLFdBQVcsQ0FBQyxFQUFFLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQyxRQUFRLEVBQUU7UUFDdkMsb0JBQW9CLEVBQUUsVUFBVTtLQUNqQyxDQUFDO0lBRUYsZ0NBQWdDO0lBQ2hDLE1BQU0sWUFBWSxHQUFHO1FBQ25CLFNBQVMsRUFBRSxVQUFVO1FBQ3JCLElBQUksRUFBRSxJQUFJO0tBQ1gsQ0FBQztJQUVGLDZDQUE2QztJQUM3QyxPQUFPLEVBQUUsQ0FBQyxHQUFHLENBQUMsWUFBWSxDQUFDLENBQUMsT0FBTyxFQUFFLENBQUM7QUFDeEMsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLy8gXCJSZWNvcmRzXCI6IFtcbi8vICAge1xuLy8gICAgIFwiZXZlbnRWZXJzaW9uXCI6IFwiMi4xXCIsXG4vLyAgICAgXCJldmVudFNvdXJjZVwiOiBcImF3czpzM1wiLFxuLy8gICAgIFwiYXdzUmVnaW9uXCI6IFwidXMtd2VzdC0yXCIsXG4vLyAgICAgXCJldmVudFRpbWVcIjogXCIyMDIwLTAyLTIyVDIyOjEyOjIzLjk5MFpcIixcbi8vICAgICBcImV2ZW50TmFtZVwiOiBcIk9iamVjdENyZWF0ZWQ6UHV0XCIsXG4vLyAgICAgXCJ1c2VySWRlbnRpdHlcIjoge1xuLy8gICAgICAgXCJwcmluY2lwYWxJZFwiOiBcIkFXUzpBUk9BNEhDRk5ZUklPWkY0VFBJRzc6TGFtYmRhQ3JvbkV4YW1wbGUtZmlsZURvd25sb2FkZXJMYW1iZGFGdW5jdGlvbjFEOUMtMVhQTDJaMldLUVhaRVwiXG4vLyAgICAgfSxcbi8vICAgICBcInJlcXVlc3RQYXJhbWV0ZXJzXCI6IHtcbi8vICAgICAgIFwic291cmNlSVBBZGRyZXNzXCI6IFwiNTIuMjcuMjAwLjkxXCJcbi8vICAgICB9LFxuLy8gICAgIFwicmVzcG9uc2VFbGVtZW50c1wiOiB7XG4vLyAgICAgICBcIngtYW16LXJlcXVlc3QtaWRcIjogXCI4MDg2QjVDODJENkQwMTBBXCIsXG4vLyAgICAgICBcIngtYW16LWlkLTJcIjogXCIrYm9mV0FZWDIvV0pPM2kzUVdpYVUwVGdLdmZsbjg2SlVsVzlsRzg3UGkxejM3VUg5eXhvVVJIUFNXUThBaU1sY2daNGtwcGxvSDV5cVRqT2d1a3VjdkRLTExCNG5MRERcIlxuLy8gICAgIH0sXG4vLyAgICAgXCJzM1wiOiB7XG4vLyAgICAgICBcInMzU2NoZW1hVmVyc2lvblwiOiBcIjEuMFwiLFxuLy8gICAgICAgXCJjb25maWd1cmF0aW9uSWRcIjogXCJPR1k0T1RVek9XVXRNalF3TkMwME5tUXdMV0kxTWpFdE16VTRPRGcxTXpJMk1qUTRcIixcbi8vICAgICAgIFwiYnVja2V0XCI6IHtcbi8vICAgICAgICAgXCJuYW1lXCI6IFwibGFtYmRhY3JvbmV4YW1wbGUtY29nY2NwZGZkb3dubG9hZHNidWNrZXQ5M2I0MGUwMS1iNHdyNDI2ODEwMnJcIixcbi8vICAgICAgICAgXCJvd25lcklkZW50aXR5XCI6IHtcbi8vICAgICAgICAgICBcInByaW5jaXBhbElkXCI6IFwiQTNJUlcwQUUyODRHRERcIlxuLy8gICAgICAgICB9LFxuLy8gICAgICAgICBcImFyblwiOiBcImFybjphd3M6czM6OjpsYW1iZGFjcm9uZXhhbXBsZS1jb2djY3BkZmRvd25sb2Fkc2J1Y2tldDkzYjQwZTAxLWI0d3I0MjY4MTAyclwiXG4vLyAgICAgICB9LFxuLy8gICAgICAgXCJvYmplY3RcIjoge1xuLy8gICAgICAgICBcImtleVwiOiBcIjUwNTUyOTgucGRmXCIsXG4vLyAgICAgICAgIFwic2l6ZVwiOiAyNyxcbi8vICAgICAgICAgXCJlVGFnXCI6IFwiZjljMjgzNzRlNTY4MGYwOGFjODFhYzJiM2I2OWI1OThcIixcbi8vICAgICAgICAgXCJzZXF1ZW5jZXJcIjogXCIwMDVFNTFBNzQ4OTUzN0U3QjRcIlxuLy8gICAgICAgfVxuLy8gICAgIH1cbi8vICAgfVxuLy8gXVxuXG4vLyAvLyAvLyAvL1xuXG5pbXBvcnQgKiBhcyBBV1MgZnJvbSBcImF3cy1zZGtcIjtcbmNvbnN0IGRiID0gbmV3IEFXUy5EeW5hbW9EQi5Eb2N1bWVudENsaWVudCgpO1xuLy8gY29uc3QgdGV4dHJhY3QgPSBuZXcgQVdTLlRleHRyYWN0KCk7XG5jb25zdCBUQUJMRV9OQU1FID0gcHJvY2Vzcy5lbnYuVEFCTEVfTkFNRSB8fCBcIlwiO1xuY29uc3QgUFJJTUFSWV9LRVkgPSBwcm9jZXNzLmVudi5QUklNQVJZX0tFWSB8fCBcIlwiO1xuY29uc3QgUzNfQlVDS0VUX05BTUUgPSBwcm9jZXNzLmVudi5TM19CVUNLRVRfTkFNRSB8fCBcIlwiO1xuY29uc3QgU05TX1RPUElDX0FSTiA9IHByb2Nlc3MuZW52LlNOU19UT1BJQ19BUk4gfHwgXCJcIjtcbmNvbnN0IFNOU19ST0xFX0FSTiA9IHByb2Nlc3MuZW52LlNOU19ST0xFX0FSTiB8fCBcIlwiO1xuXG5leHBvcnQgY29uc3QgaGFuZGxlciA9IGFzeW5jIChldmVudDogYW55ID0ge30pOiBQcm9taXNlPGFueT4gPT4ge1xuICBjb25zb2xlLmxvZyhcIlNFTkQgRklMRSBUTyBURVhUUkFDVFwiKTtcbiAgY29uc29sZS5sb2coU05TX1RPUElDX0FSTik7XG4gIGNvbnNvbGUubG9nKFNOU19ST0xFX0FSTik7XG5cbiAgY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkoZXZlbnQsIG51bGwsIDQpKTtcblxuICAvLyBQdWxscyBmaWxlbmFtZSBmcm9tIGV2ZW50XG4gIGNvbnN0IGZpbGVuYW1lID0gZXZlbnRbXCJSZWNvcmRzXCJdWzBdW1wiczNcIl1bXCJvYmplY3RcIl1bXCJrZXlcIl07XG5cbiAgLy8gU2hvcnQtY2lyY3VpdCBpZiBmaWxlbmFtZSBpc24ndCBkZWZpbmVkXG4gIGlmICghZmlsZW5hbWUpIHtcbiAgICBjb25zb2xlLmxvZyhcIkVSUk9SIC0gZmlsZW5hbWVcIik7XG4gIH1cblxuICBjb25zb2xlLmxvZyhcImZpbGVuYW1lOiBcIiArIGZpbGVuYW1lKTtcblxuICAvLyBEZWZpbmVzIHBhcmFtcyBmb3IgVGV4dHJhY3QgQVBJIGNhbGxcbiAgY29uc3QgdGV4dHJhY3RQYXJhbXM6IEFXUy5UZXh0cmFjdC5BbmFseXplRG9jdW1lbnRSZXF1ZXN0ID0ge1xuICAgIERvY3VtZW50OiB7XG4gICAgICBTM09iamVjdDoge1xuICAgICAgICBCdWNrZXQ6IFMzX0JVQ0tFVF9OQU1FLFxuICAgICAgICBOYW1lOiBmaWxlbmFtZVxuICAgICAgICAvLyBWZXJzaW9uOiBcIlNUUklOR19WQUxVRVwiXG4gICAgICB9XG4gICAgfSxcbiAgICBGZWF0dXJlVHlwZXM6IFtcIlRBQkxFU1wiLCBcIkZPUk1TXCJdXG4gIH07XG5cbiAgLy8gRGVidWcgQVdTIFRleHRyYWN0IHBhcmFtc1xuICBjb25zb2xlLmxvZyhcInRleHRyYWN0UGFyYW1zXCIpO1xuICBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeSh0ZXh0cmFjdFBhcmFtcywgbnVsbCwgNCkpO1xuXG4gIC8vIC8vIC8vIC8vXG4gIC8vIC8vIC8vIC8vXG5cbiAgLy8gQWRkIGpvYiB0byBxdWV1ZVxuXG4gIC8vIC8vIC8vIC8vXG4gIC8vIC8vIC8vIC8vXG5cbiAgLy8gRGV0ZWN0IHRoZSBkb2N1bWVudCdzIHRleHQgd2l0aCBUZXh0cmFjdFxuICAvLyBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcbiAgLy8gICB0ZXh0cmFjdC5hbmFseXplRG9jdW1lbnQodGV4dHJhY3RQYXJhbXMsIGFzeW5jIChlcnI6IGFueSwgZGF0YTogYW55KSA9PiB7XG4gIC8vICAgICBjb25zb2xlLmxvZyhcIkRPTkUgQU5BTFlaSU5HIERPQ1VNRU5UXCIpO1xuICAvLyAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgLy8gICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuXG4gIC8vICAgICBpZiAoZXJyKSB7XG4gIC8vICAgICAgIGNvbnNvbGUubG9nKGVyciwgZXJyLnN0YWNrKTtcbiAgLy8gICAgICAgcmV0dXJuO1xuICAvLyAgICAgfVxuXG4gIC8vICAgICAvLyBEZWJ1ZyBUZXh0cmFjdCByZXNwb25zZVxuICAvLyAgICAgY29uc29sZS5sb2coXCJUZXh0cmFjdCBSZXNwb25zZVwiKTtcbiAgLy8gICAgIGNvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KGRhdGEsIG51bGwsIDQpKTtcblxuICAvLyAgICAgLy8gRGVmaW5lcyB0aGUgaXRlbSB3ZSdyZSBpbnNlcnRpbmcgaW50byB0aGUgZGF0YWJhc2VcbiAgLy8gICAgIGNvbnN0IGl0ZW06IGFueSA9IHtcbiAgLy8gICAgICAgW1BSSU1BUllfS0VZXTogZmlsZW5hbWUucmVwbGFjZShcIi5wZGZcIiwgXCJcIiksXG4gIC8vICAgICAgIC8vIHByaW1hcnlfY29udGFjdF9uYW1lOiBcIkpvaG4gRG9lXCJcbiAgLy8gICAgICAgZGF0YToge1xuICAvLyAgICAgICAgIC4uLmRhdGFcbiAgLy8gICAgICAgfVxuICAvLyAgICAgfTtcblxuICAvLyAgICAgLy8gRGVmaW5lcyB0aGUgcGFyYW1zIGZvciBkYi5wdXRcbiAgLy8gICAgIGNvbnN0IGR5bmFtb1BhcmFtcyA9IHtcbiAgLy8gICAgICAgVGFibGVOYW1lOiBUQUJMRV9OQU1FLFxuICAvLyAgICAgICBJdGVtOiBpdGVtXG4gIC8vICAgICB9O1xuXG4gIC8vICAgICAvLyBJbnNlcnRzIHRoZSByZWNvcmQgaW50byB0aGUgRHluYW1vREIgdGFibGVcbiAgLy8gICAgIGF3YWl0IGRiLnB1dChkeW5hbW9QYXJhbXMpLnByb21pc2UoKTtcbiAgLy8gICAgIHJldHVybiByZXNvbHZlKCk7XG4gIC8vICAgfSk7XG4gIC8vIH0pO1xuXG4gIC8vIHJldHVybjtcblxuICAvLyAvLyAvLyAvL1xuICAvLyAvLyAvLyAvL1xuICAvLyAvLyAvLyAvL1xuICAvLyAvLyAvLyAvL1xuXG4gIC8vIERlZmluZXMgdGhlIGl0ZW0gd2UncmUgaW5zZXJ0aW5nIGludG8gdGhlIGRhdGFiYXNlXG4gIGNvbnN0IGl0ZW06IGFueSA9IHtcbiAgICBbUFJJTUFSWV9LRVldOiBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKCksXG4gICAgcHJpbWFyeV9jb250YWN0X25hbWU6IFwiSm9obiBEb2VcIlxuICB9O1xuXG4gIC8vIERlZmluZXMgdGhlIHBhcmFtcyBmb3IgZGIucHV0XG4gIGNvbnN0IGR5bmFtb1BhcmFtcyA9IHtcbiAgICBUYWJsZU5hbWU6IFRBQkxFX05BTUUsXG4gICAgSXRlbTogaXRlbVxuICB9O1xuXG4gIC8vIEluc2VydHMgdGhlIHJlY29yZCBpbnRvIHRoZSBEeW5hbW9EQiB0YWJsZVxuICByZXR1cm4gZGIucHV0KGR5bmFtb1BhcmFtcykucHJvbWlzZSgpO1xufTtcbiJdfQ==